---
layout: post
title: "gcc的使用笔记"
date: 2014-05-03 12:08
comments: true
categories: gcc
---

##gcc的工作过程
1. 预处理，生成`*.i`文件 [预处理器cpp]
2. 汇编，生成文件`*.s`文件 [编译器egcs]
3. 生成目标代码，生成`*.o`文件[汇编器as]
4. 连接目标代码，生成可执行文件[连接器ld]

##常用参数
* `-E`只预处理，文件输出到 stdout
* `-S`只预处理和编译，编译为汇编代码
* `-c`只处理预编译和、编译和汇编，生成`.o`文件
* `-I[dir]` 指定头文件的目录
>当使用了`#include "file"`的时候，查找顺序：  
>1. 当前目录  
>2. `-I`指定的目录  
>3. 系统目录  
>
>当使用了`#include <file>`的时候，查找顺序：  
>1. `-I`指定的目录  
>2. 系统目录  
* `-llbrary`指定编译的时候使用的库
* `-L[dir]`指定编译的时候，搜索库的目录
* `-static`禁止使用动态库
* `-share`尽量使用动态库
* `-M` 生成编译头文件依赖
* `-MM` 忽略`#include <file>`带来的依赖

##相关问题：
* 64bit 的 gcc 可以编译出 32bit 机器码么？  
答：可以，需要安装`gcc-multilib`，`libc6.x86`等库，编译的时候加入`-m32`参数

* gcc在编译时，静态库必须放在包含有`main()`的主文件后面，才不会出现编译错误，为了方便起见，所有链接库最好放在命令的后面（clang好像不需要这么做）


